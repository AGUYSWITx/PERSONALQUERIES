CREATE   OR ALTER    VIEW [dbo].[CUSTOMERLIST]  
AS  
  
SELECT A.MOBILE MOBILENO , A.ACID,UPPER(A.ACNAME)ACNAME,A.ADDRESS,ISNULL(A.VATNO,A.GSTNO) VATNO,A.PARENT,NULL CUS_ID,A.AREA_ID,ISNULL(A.CATEGORY,A.GEO)CATEGORY,C.ACNAME PARENT_NAME ,NULL SCHEMEID  
FROM   
 RMD_ACLIST A LEFT JOIN   
 (SELECT * FROM MEMBERSHIP WHERE ISNULL(MEMID,'') <> '') B ON A.ACID = ISNULL(B.ACCOUNT,'')   
 LEFT JOIN RMD_ACLIST C ON A.PARENT = C.ACID WHERE A.ACID LIKE 'PA%' AND A.TYPE = 'A' AND B.ACCOUNT IS NULL  
  
UNION ALL  
  
SELECT A.MOBILE MOBILENO , A.ACID,UPPER(A.ACNAME)ACNAME,A.ADDRESS,ISNULL(A.VATNO,A.GSTNO) VATNO,A.PARENT,B.MEMID CUS_ID,A.AREA_ID,ISNULL(A.CATEGORY,A.GEO)CATEGORY,C.ACNAME PARENT_NAME ,NULL SCHEMEID  
FROM RMD_ACLIST A LEFT JOIN (SELECT * FROM MEMBERSHIP WHERE ISNULL(MEMID,'') <> '') B ON A.ACID = ISNULL(B.ACCOUNT,'')   
LEFT JOIN RMD_ACLIST C ON A.PARENT = C.ACID WHERE A.ACID LIKE 'PA%' AND A.TYPE = 'A' AND B.ACCOUNT IS NOT NULL  
  
UNION ALL  
  
SELECT A.MOBILE MOBILENO , NULL ACID,UPPER(TRIM(isnull(A.FNAME,'') + ' ' + isnull(A.LNAME,''))) FNAME,A.P_STREET ADDRESS,A.PANNO VATNO,NULL PARENT,MEMID CUS_ID,NULL AREA_ID,NULL CATEGORY,NULL PARENT_NAME ,A.SCHEMEID  
FROM (SELECT * FROM MEMBERSHIP WHERE ISNULL(MEMID,'') <> '') A LEFT JOIN RMD_ACLIST B ON ISNULL(A.ACCOUNT,'~') = B.ACID  
WHERE B.ACID IS NULL AND ISNULL(A.MEMID,'') <> ''  
  
UNION ALL  
  
SELECT A.MOBILENO,NULL ACID,UPPER(A.CUSTNAME) FNAME,A.ADDRESS,A.PANNO VATNO,NULL PRENT,CUSTID,NULL AREA_ID,NULL CATEGORY,NULL PARENT_NAME,ISNULL(B.SCHEMEID,'') SCHEMEID FROM CUSTOMERPROFILE A LEFT JOIN MEMBERSHIP B  
ON A.CUSTID = B.MEMID WHERE B.MEMID IS NULL  
  