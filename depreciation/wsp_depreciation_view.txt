CREATE OR ALTER PROCEDURE [dbo].[WSP_DEPRECIATION_VIEW] @CURRENTMONTH INT,
	@PHISCALYEAR VARCHAR(25)
AS
BEGIN
	SELECT ROW_NUMBER() OVER (
			ORDER BY C.DESCA
			) SN,
		A.ACID,
		B.ACNAME Account_Heading,
		A.AssetID ASSETCODE,
		C.MENUCODE,
		C.DESCA ITEMNAME,
		A.BATCHCODE,
		A.MCODE,
		A.DEPRECIATIONRATE [Depreciation_Rate_(%)],
		A.ORIGNALCOST Cost_Value,
		A.BOOKVALUE Current_Book_Value,
		A.DEPRECIATION_VALUE Depreciation,
		A.NETBOOKVALUE Net_Book_Value
	FROM depreciation A
	LEFT JOIN RMD_ACLIST B ON A.ACID = B.ACID
	LEFT JOIN ASSET_MENUITEM C ON A.MCODE = C.MCODE
	WHERE A.MON = @CURRENTMONTH
		AND A.PHISCALID = @PHISCALYEAR

	SELECT ROW_NUMBER() OVER (
			ORDER BY C.DESCA
			) SN,
		A.ACID,
		B.ACNAME Account_Heading,
		C.MENUCODE,
		C.DESCA ITEMNAME,
		A.MCODE,
		A.DEPRECIATIONRATE [Depreciation_Rate_(%)],
		SUM(A.ORIGNALCOST) Cost_Value,
		SUM(A.BOOKVALUE) Current_Book_Value,
		SUM(A.DEPRECIATION_VALUE) Depreciation,
		SUM(A.NETBOOKVALUE) Net_Book_Value
	FROM depreciation A
	LEFT JOIN RMD_ACLIST B ON A.ACID = B.ACID
	LEFT JOIN ASSET_MENUITEM C ON A.MCODE = C.MCODE
	WHERE A.MON = @CURRENTMONTH
		AND A.PHISCALID = @PHISCALYEAR
	GROUP BY A.MCODE,
		A.ACID,
		B.ACNAME,
		A.DEPRECIATIONRATE,
		C.DESCA,
		C.MENUCODE

	SELECT ROW_NUMBER() OVER (
			ORDER BY B.ACNAME
			) SN,
		A.ACID,
		B.ACNAME Account_Heading,
		A.DEPRECIATIONRATE [Depreciation_Rate_(%)],
		SUM(A.ORIGNALCOST) Cost_Value,
		SUM(A.BOOKVALUE) Current_Book_Value,
		SUM(A.DEPRECIATION_VALUE) Depreciation,
		SUM(A.NETBOOKVALUE) Net_Book_Value
	FROM depreciation A
	LEFT JOIN RMD_ACLIST B ON A.ACID = B.ACID
	LEFT JOIN ASSET_MENUITEM C ON A.MCODE = C.MCODE
	WHERE A.MON = @CURRENTMONTH
		AND A.PHISCALID = @PHISCALYEAR
	GROUP BY A.ACID,
		B.acname,
		A.DEPRECIATIONRATE
END
GO

